import{c as oe,r as a,j as t,B as D,a as Oe,h as Tt,i as le,R as K,k as $,l as ve,m as we,P as z,n as w,o as Fe,p as Ce,q as Le,s as At,A as Ot,t as de,v as Ft,w as Lt,x as Gt,y as Kt,z as Ut,F as $t,D as zt,C as Bt,E as Yt,G as Ge,b as B,H as Vt,I as Ht,J as Wt,X as ue,T as Xt,K as qt,M as Jt,Q as Qt,U as Zt,u as en}from"./index-B6CDngGk.js";import{I as Ke}from"./input-s-Zen5Gs.js";import{S as tn,P as nn,b as Ue,A as je,a as Ne,E as $e,u as ze,T as on}from"./scroll-area-DODwmDCD.js";import{B as rn}from"./badge-By0DmhZG.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],an=oe("arrow-left",sn);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],ln=oe("check-check",cn);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],un=oe("cloud-upload",dn);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.72a10 10 0 0 1 2.69 2.7",key:"jiglxs"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.28 17.61a10 10 0 0 1-2.7 2.69",key:"elg7ff"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"m6.163 21.117-2.906.85a1 1 0 0 1-1.236-1.169l.965-2.98",key:"1qsu07"}]],pn=oe("message-circle-dashed",fn);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],xn=oe("send-horizontal",mn);function hn({chats:e,selectedChatId:n,chatMessages:o,onSelectChat:r}){const[s,c]=a.useState(!1);return a.useEffect(()=>{const l=()=>{c(window.innerWidth<=768)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),t.jsxs("div",{className:`flex h-full flex-col border-r bg-background ${s?"w-full":"w-[330px]"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 sm:py-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ke,{placeholder:"Search chat",className:"pl-10 h-9 rounded-md text-sm focus-visible:ring-0 focus-visible:ring-offset-0 w-full"})]}),t.jsxs("div",{className:"relative group flex-shrink-0",children:[t.jsx(D,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-accent","aria-label":"New Chat",children:t.jsx(nn,{className:"h-5 w-5"})}),!s&&t.jsx("span",{className:"absolute top-full mb-2 left-1/3 -translate-x-1/2 whitespace-nowrap rounded bg-gray-900 px-2 py-1 text-xs text-white opacity-0 group-hover:opacity-100 transition-opacity",children:"New Chat"})]})]}),t.jsx(Ue,{className:"flex-1",children:t.jsx("div",{className:"space-y-1 px-2 py-2",children:e.map(l=>{const f=l.id===n,m=o[l.id]||[],u=m.length>0?m[m.length-1]:null;let d="No messages yet";u&&(u.text?.trim()?d=u.text.trim():u.images&&u.images.length>0?d="ðŸ“· Photo":u.file&&(d="ðŸ“Ž File"));const i=u?.time||"";return t.jsxs("div",{onClick:()=>r(l),className:`flex cursor-pointer items-center gap-3 rounded-xl p-3 transition-colors min-h-[72px] ${f?"bg-accent":"hover:bg-accent/50"}`,children:[t.jsx(je,{className:"h-10 w-10 flex-shrink-0",children:t.jsx(Ne,{className:"text-xs",children:l.avatar})}),t.jsxs("div",{className:"min-w-0 flex-1 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsx("span",{className:"truncate text-[15px] font-medium flex-1",children:l.name}),t.jsx("span",{className:"ml-2 whitespace-nowrap text-[11px] text-muted-foreground flex-shrink-0",children:i})]}),t.jsxs("div",{className:"mt-0.5 flex items-center justify-between w-full",children:[t.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[u?.isSent&&t.jsx(ln,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:d})]}),0>0]})]})]},l.id)})})})]})}function gn({selectedChat:e}){const{name:n,avatar:o}=e,r=Oe(),s=Tt(),[c,l]=a.useState(!1);a.useEffect(()=>{const p=()=>{l(window.innerWidth<=768)};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const f=()=>{r("/community/chats")},m=!1,u=s.pathname.split("/").filter(Boolean),d=u.length===3&&u[0]==="community"&&u[1]==="chats"&&!isNaN(Number(u[2])),i=c&&d;return t.jsxs("div",{className:"flex items-center justify-between border-b bg-background p-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[i&&t.jsx(D,{variant:"ghost",size:"icon",className:"h-9 w-9 p-0 rounded-full hover:bg-accent",onClick:f,"aria-label":"Back to chats",children:t.jsx(an,{className:"h-5 w-5"})}),t.jsxs("div",{className:"relative",children:[t.jsxs(je,{className:"h-10 w-10",children:[m,t.jsx(Ne,{className:"text-xs",children:o})]}),t.jsx("span",{className:"absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-background bg-green-500"})]}),t.jsx("span",{className:"font-semibold",children:n})]}),t.jsx(D,{variant:"ghost",size:"icon","aria-label":"Chat options",children:t.jsx($e,{className:"h-5 w-5"})})]})}function Be(e){const n=e+"CollectionProvider",[o,r]=le(n),[s,c]=o(n,{collectionRef:{current:null},itemMap:new Map}),l=C=>{const{scope:h,children:j}=C,N=K.useRef(null),b=K.useRef(new Map).current;return t.jsx(s,{scope:h,itemMap:b,collectionRef:N,children:j})};l.displayName=n;const f=e+"CollectionSlot",m=ve(f),u=K.forwardRef((C,h)=>{const{scope:j,children:N}=C,b=c(f,j),y=$(h,b.collectionRef);return t.jsx(m,{ref:y,children:N})});u.displayName=f;const d=e+"CollectionItemSlot",i="data-radix-collection-item",p=ve(d),M=K.forwardRef((C,h)=>{const{scope:j,children:N,...b}=C,y=K.useRef(null),P=$(h,y),T=c(d,j);return K.useEffect(()=>(T.itemMap.set(y,{ref:y,...b}),()=>void T.itemMap.delete(y))),t.jsx(p,{[i]:"",ref:P,children:N})});M.displayName=d;function g(C){const h=c(e+"CollectionConsumer",C);return K.useCallback(()=>{const N=h.collectionRef.current;if(!N)return[];const b=Array.from(N.querySelectorAll(`[${i}]`));return Array.from(h.itemMap.values()).sort((T,A)=>b.indexOf(T.ref.current)-b.indexOf(A.ref.current))},[h.collectionRef,h.itemMap])}return[{Provider:l,Slot:u,ItemSlot:M},g,r]}var ge="rovingFocusGroup.onEntryFocus",vn={bubbles:!1,cancelable:!0},re="RovingFocusGroup",[Me,Ye,wn]=Be(re),[Mn,Ve]=le(re,[wn]),[bn,Cn]=Mn(re),He=a.forwardRef((e,n)=>t.jsx(Me.Provider,{scope:e.__scopeRovingFocusGroup,children:t.jsx(Me.Slot,{scope:e.__scopeRovingFocusGroup,children:t.jsx(jn,{...e,ref:n})})}));He.displayName=re;var jn=a.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:o,orientation:r,loop:s=!1,dir:c,currentTabStopId:l,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:m,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...i}=e,p=a.useRef(null),M=$(n,p),g=ze(c),[C,h]=Fe({prop:l,defaultProp:f??null,onChange:m,caller:re}),[j,N]=a.useState(!1),b=Ce(u),y=Ye(o),P=a.useRef(!1),[T,A]=a.useState(0);return a.useEffect(()=>{const _=p.current;if(_)return _.addEventListener(ge,b),()=>_.removeEventListener(ge,b)},[b]),t.jsx(bn,{scope:o,orientation:r,dir:g,loop:s,currentTabStopId:C,onItemFocus:a.useCallback(_=>h(_),[h]),onItemShiftTab:a.useCallback(()=>N(!0),[]),onFocusableItemAdd:a.useCallback(()=>A(_=>_+1),[]),onFocusableItemRemove:a.useCallback(()=>A(_=>_-1),[]),children:t.jsx(z.div,{tabIndex:j||T===0?-1:0,"data-orientation":r,...i,ref:M,style:{outline:"none",...e.style},onMouseDown:w(e.onMouseDown,()=>{P.current=!0}),onFocus:w(e.onFocus,_=>{const F=!P.current;if(_.target===_.currentTarget&&F&&!j){const L=new CustomEvent(ge,vn);if(_.currentTarget.dispatchEvent(L),!L.defaultPrevented){const Y=y().filter(S=>S.focusable),U=Y.find(S=>S.active),X=Y.find(S=>S.id===C),R=[U,X,...Y].filter(Boolean).map(S=>S.ref.current);qe(R,d)}}P.current=!1}),onBlur:w(e.onBlur,()=>N(!1))})})}),We="RovingFocusGroupItem",Xe=a.forwardRef((e,n)=>{const{__scopeRovingFocusGroup:o,focusable:r=!0,active:s=!1,tabStopId:c,children:l,...f}=e,m=we(),u=c||m,d=Cn(We,o),i=d.currentTabStopId===u,p=Ye(o),{onFocusableItemAdd:M,onFocusableItemRemove:g,currentTabStopId:C}=d;return a.useEffect(()=>{if(r)return M(),()=>g()},[r,M,g]),t.jsx(Me.ItemSlot,{scope:o,id:u,focusable:r,active:s,children:t.jsx(z.span,{tabIndex:i?0:-1,"data-orientation":d.orientation,...f,ref:n,onMouseDown:w(e.onMouseDown,h=>{r?d.onItemFocus(u):h.preventDefault()}),onFocus:w(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:w(e.onKeyDown,h=>{if(h.key==="Tab"&&h.shiftKey){d.onItemShiftTab();return}if(h.target!==h.currentTarget)return;const j=Rn(h,d.orientation,d.dir);if(j!==void 0){if(h.metaKey||h.ctrlKey||h.altKey||h.shiftKey)return;h.preventDefault();let b=p().filter(y=>y.focusable).map(y=>y.ref.current);if(j==="last")b.reverse();else if(j==="prev"||j==="next"){j==="prev"&&b.reverse();const y=b.indexOf(h.currentTarget);b=d.loop?Sn(b,y+1):b.slice(y+1)}setTimeout(()=>qe(b))}}),children:typeof l=="function"?l({isCurrentTabStop:i,hasTabStop:C!=null}):l})})});Xe.displayName=We;var Nn={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function yn(e,n){return n!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Rn(e,n,o){const r=yn(e.key,o);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Nn[r]}function qe(e,n=!1){const o=document.activeElement;for(const r of e)if(r===o||(r.focus({preventScroll:n}),document.activeElement!==o))return}function Sn(e,n){return e.map((o,r)=>e[(n+r)%e.length])}var _n=He,In=Xe,be=["Enter"," "],En=["ArrowDown","PageUp","Home"],Je=["ArrowUp","PageDown","End"],Dn=[...En,...Je],kn={ltr:[...be,"ArrowRight"],rtl:[...be,"ArrowLeft"]},Pn={ltr:["ArrowLeft"],rtl:["ArrowRight"]},se="Menu",[te,Tn,An]=Be(se),[H,Qe]=le(se,[An,Le,Ve]),fe=Le(),Ze=Ve(),[On,W]=H(se),[Fn,ae]=H(se),et=e=>{const{__scopeMenu:n,open:o=!1,children:r,dir:s,onOpenChange:c,modal:l=!0}=e,f=fe(n),[m,u]=a.useState(null),d=a.useRef(!1),i=Ce(c),p=ze(s);return a.useEffect(()=>{const M=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",M,{capture:!0}),()=>{document.removeEventListener("keydown",M,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),t.jsx(At,{...f,children:t.jsx(On,{scope:n,open:o,onOpenChange:i,content:m,onContentChange:u,children:t.jsx(Fn,{scope:n,onClose:a.useCallback(()=>i(!1),[i]),isUsingKeyboardRef:d,dir:p,modal:l,children:r})})})};et.displayName=se;var Ln="MenuAnchor",ye=a.forwardRef((e,n)=>{const{__scopeMenu:o,...r}=e,s=fe(o);return t.jsx(Ot,{...s,...r,ref:n})});ye.displayName=Ln;var Re="MenuPortal",[Gn,tt]=H(Re,{forceMount:void 0}),nt=e=>{const{__scopeMenu:n,forceMount:o,children:r,container:s}=e,c=W(Re,n);return t.jsx(Gn,{scope:n,forceMount:o,children:t.jsx(de,{present:o||c.open,children:t.jsx(Ft,{asChild:!0,container:s,children:r})})})};nt.displayName=Re;var k="MenuContent",[Kn,Se]=H(k),ot=a.forwardRef((e,n)=>{const o=tt(k,e.__scopeMenu),{forceMount:r=o.forceMount,...s}=e,c=W(k,e.__scopeMenu),l=ae(k,e.__scopeMenu);return t.jsx(te.Provider,{scope:e.__scopeMenu,children:t.jsx(de,{present:r||c.open,children:t.jsx(te.Slot,{scope:e.__scopeMenu,children:l.modal?t.jsx(Un,{...s,ref:n}):t.jsx($n,{...s,ref:n})})})})}),Un=a.forwardRef((e,n)=>{const o=W(k,e.__scopeMenu),r=a.useRef(null),s=$(n,r);return a.useEffect(()=>{const c=r.current;if(c)return Lt(c)},[]),t.jsx(_e,{...e,ref:s,trapFocus:o.open,disableOutsidePointerEvents:o.open,disableOutsideScroll:!0,onFocusOutside:w(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>o.onOpenChange(!1)})}),$n=a.forwardRef((e,n)=>{const o=W(k,e.__scopeMenu);return t.jsx(_e,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>o.onOpenChange(!1)})}),zn=ve("MenuContent.ScrollLock"),_e=a.forwardRef((e,n)=>{const{__scopeMenu:o,loop:r=!1,trapFocus:s,onOpenAutoFocus:c,onCloseAutoFocus:l,disableOutsidePointerEvents:f,onEntryFocus:m,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:i,onInteractOutside:p,onDismiss:M,disableOutsideScroll:g,...C}=e,h=W(k,o),j=ae(k,o),N=fe(o),b=Ze(o),y=Tn(o),[P,T]=a.useState(null),A=a.useRef(null),_=$(n,A,h.onContentChange),F=a.useRef(0),L=a.useRef(""),Y=a.useRef(0),U=a.useRef(null),X=a.useRef("right"),v=a.useRef(0),R=g?Ut:a.Fragment,S=g?{as:zn,allowPinchZoom:!0}:void 0,O=x=>{const q=L.current+x,V=y().filter(E=>!E.disabled),Q=document.activeElement,xe=V.find(E=>E.ref.current===Q)?.textValue,he=V.map(E=>E.textValue),ke=to(he,q,xe),Z=V.find(E=>E.textValue===ke)?.ref.current;(function E(Pe){L.current=Pe,window.clearTimeout(F.current),Pe!==""&&(F.current=window.setTimeout(()=>E(""),1e3))})(q),Z&&setTimeout(()=>Z.focus())};a.useEffect(()=>()=>window.clearTimeout(F.current),[]),Kt();const G=a.useCallback(x=>X.current===U.current?.side&&oo(x,U.current?.area),[]);return t.jsx(Kn,{scope:o,searchRef:L,onItemEnter:a.useCallback(x=>{G(x)&&x.preventDefault()},[G]),onItemLeave:a.useCallback(x=>{G(x)||(A.current?.focus(),T(null))},[G]),onTriggerLeave:a.useCallback(x=>{G(x)&&x.preventDefault()},[G]),pointerGraceTimerRef:Y,onPointerGraceIntentChange:a.useCallback(x=>{U.current=x},[]),children:t.jsx(R,{...S,children:t.jsx($t,{asChild:!0,trapped:s,onMountAutoFocus:w(c,x=>{x.preventDefault(),A.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:t.jsx(zt,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:i,onInteractOutside:p,onDismiss:M,children:t.jsx(_n,{asChild:!0,...b,dir:j.dir,orientation:"vertical",loop:r,currentTabStopId:P,onCurrentTabStopIdChange:T,onEntryFocus:w(m,x=>{j.isUsingKeyboardRef.current||x.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(Bt,{role:"menu","aria-orientation":"vertical","data-state":wt(h.open),"data-radix-menu-content":"",dir:j.dir,...N,...C,ref:_,style:{outline:"none",...C.style},onKeyDown:w(C.onKeyDown,x=>{const V=x.target.closest("[data-radix-menu-content]")===x.currentTarget,Q=x.ctrlKey||x.altKey||x.metaKey,xe=x.key.length===1;V&&(x.key==="Tab"&&x.preventDefault(),!Q&&xe&&O(x.key));const he=A.current;if(x.target!==he||!Dn.includes(x.key))return;x.preventDefault();const Z=y().filter(E=>!E.disabled).map(E=>E.ref.current);Je.includes(x.key)&&Z.reverse(),Zn(Z)}),onBlur:w(e.onBlur,x=>{x.currentTarget.contains(x.target)||(window.clearTimeout(F.current),L.current="")}),onPointerMove:w(e.onPointerMove,ne(x=>{const q=x.target,V=v.current!==x.clientX;if(x.currentTarget.contains(q)&&V){const Q=x.clientX>v.current?"right":"left";X.current=Q,v.current=x.clientX}}))})})})})})})});ot.displayName=k;var Bn="MenuGroup",Ie=a.forwardRef((e,n)=>{const{__scopeMenu:o,...r}=e;return t.jsx(z.div,{role:"group",...r,ref:n})});Ie.displayName=Bn;var Yn="MenuLabel",rt=a.forwardRef((e,n)=>{const{__scopeMenu:o,...r}=e;return t.jsx(z.div,{...r,ref:n})});rt.displayName=Yn;var ce="MenuItem",Te="menu.itemSelect",pe=a.forwardRef((e,n)=>{const{disabled:o=!1,onSelect:r,...s}=e,c=a.useRef(null),l=ae(ce,e.__scopeMenu),f=Se(ce,e.__scopeMenu),m=$(n,c),u=a.useRef(!1),d=()=>{const i=c.current;if(!o&&i){const p=new CustomEvent(Te,{bubbles:!0,cancelable:!0});i.addEventListener(Te,M=>r?.(M),{once:!0}),Gt(i,p),p.defaultPrevented?u.current=!1:l.onClose()}};return t.jsx(st,{...s,ref:m,disabled:o,onClick:w(e.onClick,d),onPointerDown:i=>{e.onPointerDown?.(i),u.current=!0},onPointerUp:w(e.onPointerUp,i=>{u.current||i.currentTarget?.click()}),onKeyDown:w(e.onKeyDown,i=>{const p=f.searchRef.current!=="";o||p&&i.key===" "||be.includes(i.key)&&(i.currentTarget.click(),i.preventDefault())})})});pe.displayName=ce;var st=a.forwardRef((e,n)=>{const{__scopeMenu:o,disabled:r=!1,textValue:s,...c}=e,l=Se(ce,o),f=Ze(o),m=a.useRef(null),u=$(n,m),[d,i]=a.useState(!1),[p,M]=a.useState("");return a.useEffect(()=>{const g=m.current;g&&M((g.textContent??"").trim())},[c.children]),t.jsx(te.ItemSlot,{scope:o,disabled:r,textValue:s??p,children:t.jsx(In,{asChild:!0,...f,focusable:!r,children:t.jsx(z.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...c,ref:u,onPointerMove:w(e.onPointerMove,ne(g=>{r?l.onItemLeave(g):(l.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(e.onPointerLeave,ne(g=>l.onItemLeave(g))),onFocus:w(e.onFocus,()=>i(!0)),onBlur:w(e.onBlur,()=>i(!1))})})})}),Vn="MenuCheckboxItem",at=a.forwardRef((e,n)=>{const{checked:o=!1,onCheckedChange:r,...s}=e;return t.jsx(ut,{scope:e.__scopeMenu,checked:o,children:t.jsx(pe,{role:"menuitemcheckbox","aria-checked":ie(o)?"mixed":o,...s,ref:n,"data-state":De(o),onSelect:w(s.onSelect,()=>r?.(ie(o)?!0:!o),{checkForDefaultPrevented:!1})})})});at.displayName=Vn;var ct="MenuRadioGroup",[Hn,Wn]=H(ct,{value:void 0,onValueChange:()=>{}}),it=a.forwardRef((e,n)=>{const{value:o,onValueChange:r,...s}=e,c=Ce(r);return t.jsx(Hn,{scope:e.__scopeMenu,value:o,onValueChange:c,children:t.jsx(Ie,{...s,ref:n})})});it.displayName=ct;var lt="MenuRadioItem",dt=a.forwardRef((e,n)=>{const{value:o,...r}=e,s=Wn(lt,e.__scopeMenu),c=o===s.value;return t.jsx(ut,{scope:e.__scopeMenu,checked:c,children:t.jsx(pe,{role:"menuitemradio","aria-checked":c,...r,ref:n,"data-state":De(c),onSelect:w(r.onSelect,()=>s.onValueChange?.(o),{checkForDefaultPrevented:!1})})})});dt.displayName=lt;var Ee="MenuItemIndicator",[ut,Xn]=H(Ee,{checked:!1}),ft=a.forwardRef((e,n)=>{const{__scopeMenu:o,forceMount:r,...s}=e,c=Xn(Ee,o);return t.jsx(de,{present:r||ie(c.checked)||c.checked===!0,children:t.jsx(z.span,{...s,ref:n,"data-state":De(c.checked)})})});ft.displayName=Ee;var qn="MenuSeparator",pt=a.forwardRef((e,n)=>{const{__scopeMenu:o,...r}=e;return t.jsx(z.div,{role:"separator","aria-orientation":"horizontal",...r,ref:n})});pt.displayName=qn;var Jn="MenuArrow",mt=a.forwardRef((e,n)=>{const{__scopeMenu:o,...r}=e,s=fe(o);return t.jsx(Yt,{...s,...r,ref:n})});mt.displayName=Jn;var Qn="MenuSub",[ur,xt]=H(Qn),ee="MenuSubTrigger",ht=a.forwardRef((e,n)=>{const o=W(ee,e.__scopeMenu),r=ae(ee,e.__scopeMenu),s=xt(ee,e.__scopeMenu),c=Se(ee,e.__scopeMenu),l=a.useRef(null),{pointerGraceTimerRef:f,onPointerGraceIntentChange:m}=c,u={__scopeMenu:e.__scopeMenu},d=a.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return a.useEffect(()=>d,[d]),a.useEffect(()=>{const i=f.current;return()=>{window.clearTimeout(i),m(null)}},[f,m]),t.jsx(ye,{asChild:!0,...u,children:t.jsx(st,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":s.contentId,"data-state":wt(o.open),...e,ref:Ge(n,s.onTriggerChange),onClick:i=>{e.onClick?.(i),!(e.disabled||i.defaultPrevented)&&(i.currentTarget.focus(),o.open||o.onOpenChange(!0))},onPointerMove:w(e.onPointerMove,ne(i=>{c.onItemEnter(i),!i.defaultPrevented&&!e.disabled&&!o.open&&!l.current&&(c.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{o.onOpenChange(!0),d()},100))})),onPointerLeave:w(e.onPointerLeave,ne(i=>{d();const p=o.content?.getBoundingClientRect();if(p){const M=o.content?.dataset.side,g=M==="right",C=g?-5:5,h=p[g?"left":"right"],j=p[g?"right":"left"];c.onPointerGraceIntentChange({area:[{x:i.clientX+C,y:i.clientY},{x:h,y:p.top},{x:j,y:p.top},{x:j,y:p.bottom},{x:h,y:p.bottom}],side:M}),window.clearTimeout(f.current),f.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(i),i.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:w(e.onKeyDown,i=>{const p=c.searchRef.current!=="";e.disabled||p&&i.key===" "||kn[r.dir].includes(i.key)&&(o.onOpenChange(!0),o.content?.focus(),i.preventDefault())})})})});ht.displayName=ee;var gt="MenuSubContent",vt=a.forwardRef((e,n)=>{const o=tt(k,e.__scopeMenu),{forceMount:r=o.forceMount,...s}=e,c=W(k,e.__scopeMenu),l=ae(k,e.__scopeMenu),f=xt(gt,e.__scopeMenu),m=a.useRef(null),u=$(n,m);return t.jsx(te.Provider,{scope:e.__scopeMenu,children:t.jsx(de,{present:r||c.open,children:t.jsx(te.Slot,{scope:e.__scopeMenu,children:t.jsx(_e,{id:f.contentId,"aria-labelledby":f.triggerId,...s,ref:u,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{l.isUsingKeyboardRef.current&&m.current?.focus(),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:w(e.onFocusOutside,d=>{d.target!==f.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:w(e.onEscapeKeyDown,d=>{l.onClose(),d.preventDefault()}),onKeyDown:w(e.onKeyDown,d=>{const i=d.currentTarget.contains(d.target),p=Pn[l.dir].includes(d.key);i&&p&&(c.onOpenChange(!1),f.trigger?.focus(),d.preventDefault())})})})})})});vt.displayName=gt;function wt(e){return e?"open":"closed"}function ie(e){return e==="indeterminate"}function De(e){return ie(e)?"indeterminate":e?"checked":"unchecked"}function Zn(e){const n=document.activeElement;for(const o of e)if(o===n||(o.focus(),document.activeElement!==n))return}function eo(e,n){return e.map((o,r)=>e[(n+r)%e.length])}function to(e,n,o){const s=n.length>1&&Array.from(n).every(u=>u===n[0])?n[0]:n,c=o?e.indexOf(o):-1;let l=eo(e,Math.max(c,0));s.length===1&&(l=l.filter(u=>u!==o));const m=l.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return m!==o?m:void 0}function no(e,n){const{x:o,y:r}=e;let s=!1;for(let c=0,l=n.length-1;c<n.length;l=c++){const f=n[c],m=n[l],u=f.x,d=f.y,i=m.x,p=m.y;d>r!=p>r&&o<(i-u)*(r-d)/(p-d)+u&&(s=!s)}return s}function oo(e,n){if(!n)return!1;const o={x:e.clientX,y:e.clientY};return no(o,n)}function ne(e){return n=>n.pointerType==="mouse"?e(n):void 0}var ro=et,so=ye,ao=nt,co=ot,io=Ie,lo=rt,uo=pe,fo=at,po=it,mo=dt,xo=ft,ho=pt,go=mt,vo=ht,wo=vt,me="DropdownMenu",[Mo]=le(me,[Qe]),I=Qe(),[bo,Mt]=Mo(me),bt=e=>{const{__scopeDropdownMenu:n,children:o,dir:r,open:s,defaultOpen:c,onOpenChange:l,modal:f=!0}=e,m=I(n),u=a.useRef(null),[d,i]=Fe({prop:s,defaultProp:c??!1,onChange:l,caller:me});return t.jsx(bo,{scope:n,triggerId:we(),triggerRef:u,contentId:we(),open:d,onOpenChange:i,onOpenToggle:a.useCallback(()=>i(p=>!p),[i]),modal:f,children:t.jsx(ro,{...m,open:d,onOpenChange:i,dir:r,modal:f,children:o})})};bt.displayName=me;var Ct="DropdownMenuTrigger",jt=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,disabled:r=!1,...s}=e,c=Mt(Ct,o),l=I(o);return t.jsx(so,{asChild:!0,...l,children:t.jsx(z.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Ge(n,c.triggerRef),onPointerDown:w(e.onPointerDown,f=>{!r&&f.button===0&&f.ctrlKey===!1&&(c.onOpenToggle(),c.open||f.preventDefault())}),onKeyDown:w(e.onKeyDown,f=>{r||(["Enter"," "].includes(f.key)&&c.onOpenToggle(),f.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});jt.displayName=Ct;var Co="DropdownMenuPortal",Nt=e=>{const{__scopeDropdownMenu:n,...o}=e,r=I(n);return t.jsx(ao,{...r,...o})};Nt.displayName=Co;var yt="DropdownMenuContent",Rt=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=Mt(yt,o),c=I(o),l=a.useRef(!1);return t.jsx(co,{id:s.contentId,"aria-labelledby":s.triggerId,...c,...r,ref:n,onCloseAutoFocus:w(e.onCloseAutoFocus,f=>{l.current||s.triggerRef.current?.focus(),l.current=!1,f.preventDefault()}),onInteractOutside:w(e.onInteractOutside,f=>{const m=f.detail.originalEvent,u=m.button===0&&m.ctrlKey===!0,d=m.button===2||u;(!s.modal||d)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Rt.displayName=yt;var jo="DropdownMenuGroup",No=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(io,{...s,...r,ref:n})});No.displayName=jo;var yo="DropdownMenuLabel",Ro=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(lo,{...s,...r,ref:n})});Ro.displayName=yo;var So="DropdownMenuItem",St=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(uo,{...s,...r,ref:n})});St.displayName=So;var _o="DropdownMenuCheckboxItem",Io=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(fo,{...s,...r,ref:n})});Io.displayName=_o;var Eo="DropdownMenuRadioGroup",Do=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(po,{...s,...r,ref:n})});Do.displayName=Eo;var ko="DropdownMenuRadioItem",Po=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(mo,{...s,...r,ref:n})});Po.displayName=ko;var To="DropdownMenuItemIndicator",Ao=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(xo,{...s,...r,ref:n})});Ao.displayName=To;var Oo="DropdownMenuSeparator",Fo=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(ho,{...s,...r,ref:n})});Fo.displayName=Oo;var Lo="DropdownMenuArrow",Go=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(go,{...s,...r,ref:n})});Go.displayName=Lo;var Ko="DropdownMenuSubTrigger",Uo=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(vo,{...s,...r,ref:n})});Uo.displayName=Ko;var $o="DropdownMenuSubContent",zo=a.forwardRef((e,n)=>{const{__scopeDropdownMenu:o,...r}=e,s=I(o);return t.jsx(wo,{...s,...r,ref:n,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zo.displayName=$o;var Bo=bt,Yo=jt,Vo=Nt,Ho=Rt,Wo=St;function Xo({...e}){return t.jsx(Bo,{"data-slot":"dropdown-menu",...e})}function qo({...e}){return t.jsx(Yo,{"data-slot":"dropdown-menu-trigger",...e})}function Jo({className:e,sideOffset:n=4,...o}){return t.jsx(Vo,{children:t.jsx(Ho,{"data-slot":"dropdown-menu-content",sideOffset:n,className:B("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function Ae({className:e,inset:n,variant:o="default",...r}){return t.jsx(Wo,{"data-slot":"dropdown-menu-item","data-inset":n,"data-variant":o,className:B("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function _t({...e}){return t.jsx(Vt,{"data-slot":"dialog",...e})}function Qo({...e}){return t.jsx(Jt,{"data-slot":"dialog-portal",...e})}function Zo({className:e,...n}){return t.jsx(Qt,{"data-slot":"dialog-overlay",className:B("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...n})}function It({className:e,children:n,showCloseButton:o=!0,...r}){return t.jsxs(Qo,{"data-slot":"dialog-portal",children:[t.jsx(Zo,{}),t.jsxs(Ht,{"data-slot":"dialog-content",className:B("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...r,children:[n,o&&t.jsxs(Wt,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[t.jsx(ue,{}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Et({className:e,...n}){return t.jsx("div",{"data-slot":"dialog-header",className:B("flex flex-col gap-2 text-center sm:text-left",e),...n})}function Dt({className:e,...n}){return t.jsx("div",{"data-slot":"dialog-footer",className:B("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...n})}function kt({className:e,...n}){return t.jsx(Xt,{"data-slot":"dialog-title",className:B("text-lg leading-none font-semibold",e),...n})}function Pt({className:e,...n}){return t.jsx(qt,{"data-slot":"dialog-description",className:B("text-muted-foreground text-sm",e),...n})}function er({isOpen:e,onClose:n,onSave:o,initialText:r,initialImages:s}){const[c,l]=a.useState(r),[f,m]=a.useState(s);a.useEffect(()=>{e&&(l(r),m(s))},[e,r,s]);const u=i=>{m(f.filter((p,M)=>M!==i))},d=()=>{o(c,f)};return t.jsx(_t,{open:e,onOpenChange:n,children:t.jsxs(It,{className:"sm:max-w-[500px]",children:[t.jsxs(Et,{children:[t.jsx(kt,{children:"Edit Message"}),t.jsx(Pt,{children:"Make changes to your message. Click save when you're done."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsx(on,{value:c,onChange:i=>l(i.target.value),placeholder:"Type your message...",className:"min-h-[100px]"}),f.length>0&&t.jsx("div",{className:"grid grid-cols-3 gap-3",children:f.map((i,p)=>t.jsxs("div",{className:"relative group",children:[t.jsx("img",{src:i.trim(),alt:`Image ${p+1}`,className:"rounded-lg w-full h-24 object-cover"}),t.jsx("button",{onClick:()=>u(p),className:"absolute top-1 right-1 bg-black/60 hover:bg-black/80 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Remove image",children:t.jsx(ue,{className:"h-3 w-3"})})]},p))})]}),t.jsxs(Dt,{children:[t.jsx(D,{variant:"outline",onClick:n,children:"Cancel"}),t.jsx(D,{onClick:d,children:"Save Changes"})]})]})})}function tr({isOpen:e,onClose:n,onConfirm:o}){return t.jsx(_t,{open:e,onOpenChange:n,children:t.jsxs(It,{className:"sm:max-w-[425px]",children:[t.jsxs(Et,{children:[t.jsx(kt,{children:"Delete Message"}),t.jsx(Pt,{children:"Are you sure you want to delete this message? This action cannot be undone."})]}),t.jsxs(Dt,{children:[t.jsx(D,{variant:"outline",onClick:n,children:"Cancel"}),t.jsx(D,{variant:"destructive",onClick:o,children:"Delete"})]})]})})}function nr({msg:e,onReply:n,onEdit:o,onDelete:r}){const{sender:s,role:c,avatar:l,time:f,text:m,images:u,replyTo:d,isSent:i}=e,[p,M]=a.useState(!1),[g,C]=a.useState(!1),h=(N,b)=>{o&&o(e.id,N,b),M(!1)},j=()=>{r&&r(e.id),C(!1)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`flex w-full ${i?"justify-end":"justify-start"} mb-4 px-2`,children:t.jsxs("div",{className:"max-w-[85vw] sm:max-w-[500px] w-full rounded-2xl border bg-background p-3 shadow-sm",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsx(je,{className:"h-8 w-8 flex-shrink-0",children:t.jsx(Ne,{className:"text-xs",children:l})}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-sm font-semibold truncate",children:s}),t.jsx(rn,{variant:"secondary",className:"text-[9px] px-1.5 py-0 h-4 flex-shrink-0",children:c})]}),t.jsx("span",{className:"text-[11px] text-muted-foreground",children:f})]})]}),t.jsxs(Xo,{children:[t.jsx(qo,{asChild:!0,children:t.jsx(D,{variant:"ghost",size:"icon",className:"text-muted-foreground h-7 w-7","aria-label":"Message options",children:t.jsx($e,{className:"h-4 w-4"})})}),t.jsxs(Jo,{align:"end",children:[t.jsx(Ae,{onClick:()=>M(!0),children:"Edit"}),t.jsx(Ae,{onClick:()=>C(!0),children:"Delete"})]})]})]}),d&&t.jsx("div",{className:"mb-2",children:t.jsxs("div",{className:"flex items-start gap-2 rounded-md bg-muted p-2 text-[13px]",children:[t.jsxs("span",{className:"font-medium text-muted-foreground shrink-0",children:[d.sender,":"]}),t.jsx("span",{className:"text-muted-foreground break-words",children:d.text})]})}),m&&t.jsx("p",{className:"mb-2 text-[15px] leading-relaxed text-foreground break-words",children:m}),u&&u.length>0&&t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 mb-3",children:u.map(N=>N.trim()).filter(N=>N.length>0).map((N,b)=>t.jsx("img",{src:N,alt:"Attached content",className:"rounded-lg w-full h-32 object-cover"},b))}),t.jsx("div",{className:"mt-2 flex justify-center",children:t.jsxs(D,{variant:"ghost",className:"h-auto px-2 py-1 text-[13px] text-muted-foreground hover:bg-transparent",onClick:()=>n(e),"aria-label":"Reply to message",children:[t.jsx(pn,{className:"h-4 w-4"}),t.jsx("span",{className:"ml-1",children:"Reply"})]})})]})}),t.jsx(er,{isOpen:p,onClose:()=>M(!1),onSave:h,initialText:m||"",initialImages:u||[]}),t.jsx(tr,{isOpen:g,onClose:()=>C(!1),onConfirm:j})]})}function or({messages:e,onReply:n,onEdit:o,onDelete:r}){const s=a.useRef(null);return a.useEffect(()=>{s.current?.scrollIntoView({behavior:"smooth"})},[e]),t.jsxs(Ue,{className:"flex-1 px-4 py-6 space-y-6 bg-white",children:[e.length===0?t.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"No messages yet. Start the conversation!"}):e.map(c=>t.jsx(nr,{msg:c,onReply:n,onEdit:o,onDelete:r},c.id)),t.jsx("div",{ref:s})]})}function rr({replyingTo:e,onCancel:n}){if(!e)return null;const{sender:o,text:r}=e;return t.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-4 py-2.5 rounded-lg border bg-muted mx-2 sm:mx-6",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsx("span",{className:"text-[13px] font-medium text-muted-foreground shrink-0",children:"Replying to"}),t.jsx("span",{className:"text-[13px] font-semibold truncate",children:o}),t.jsx("span",{className:"text-[13px] text-muted-foreground truncate min-w-0",children:r})]}),t.jsx(D,{size:"icon",variant:"ghost",className:"h-6 w-6 flex-shrink-0",onClick:n,"aria-label":"Cancel reply",children:t.jsx(ue,{className:"h-3.5 w-3.5 text-muted-foreground"})})]})}function sr({message:e,setMessage:n,onSend:o,fileInputRef:r,onFileSelect:s,selectedFile:c,filePreview:l,onRemoveFile:f}){const m=a.useRef(null),[u,d]=K.useState(!1);K.useEffect(()=>{const p=()=>{d(window.innerWidth<=768)};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),a.useEffect(()=>{c&&m.current&&m.current.focus()},[c]);const i=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),o())};return t.jsxs("div",{className:"bg-white p-2 flex flex-col gap-2",style:{paddingBottom:u?"env(safe-area-inset-bottom, 8px)":"8px"},children:[c&&t.jsxs("div",{className:"border p-2 rounded-md bg-gray-100 flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs font-medium truncate",children:c.name}),l&&t.jsx("img",{src:l,alt:"Preview",className:"w-full max-w-full sm:max-w-[240px] h-24 object-cover rounded-md mt-1.5"})]}),t.jsx(D,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-2 flex-shrink-0 p-0",onClick:f,"aria-label":"Remove file",children:t.jsx(ue,{className:"w-3.5 h-3.5 text-red-500"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"file",ref:r,className:"hidden",onChange:s}),t.jsx(D,{variant:"ghost",size:"icon",onClick:()=>r.current?.click(),className:"h-9 w-9 flex-shrink-0 rounded-full hover:bg-gray-200","aria-label":"Attach file",children:t.jsx(un,{className:"w-5 h-5 text-gray-700"})}),t.jsx(Ke,{ref:m,placeholder:"Type your message...",value:e,onChange:p=>n(p.target.value),onKeyDown:i,className:"flex-1 rounded-full border border-gray-300 bg-gray-100 focus:bg-white focus:border-gray-400 focus:ring-0 focus:ring-offset-0 min-w-0 text-sm py-2 px-4"}),t.jsx(D,{onClick:o,disabled:!e.trim()&&!c,className:"h-9 w-9 flex items-center justify-center rounded-full bg-green-500 hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed flex-shrink-0","aria-label":"Send message",children:t.jsx(xn,{className:"w-5 h-5 text-white"})})]})]})}const J=[{id:1,name:"Gladys Nimo",avatar:"GN"},{id:2,name:"Edem Nunu",avatar:"EN"},{id:3,name:"Oboi Siki",avatar:"OS"},{id:4,name:"Nana Yaa",avatar:"NY"},{id:5,name:"Rejoice",avatar:"RE"}],ar={5:[{id:1,sender:"Rejoice",avatar:"RE",role:"STUDENT",text:"Hi, let's have a meeting tomorrow...",images:["https://picsum.photos/seed/cow1/400/300"],time:"3:12 pm",isSent:!1},{id:2,sender:"You",avatar:"YO",role:"STUDENT",text:"Sure! Let's meet at 10 AM.",images:[],time:"3:14 pm",isSent:!0}]};function fr(){const{userId:e}=Zt(),n=Oe(),[o,r]=a.useState(!1);a.useEffect(()=>{const v=()=>{r(window.innerWidth<=768)};return v(),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[]);const[s,c]=a.useState(J[0]),[l,f]=a.useState(()=>{const v={};return J.forEach(R=>{v[R.id]=ar[R.id]||[]}),v});a.useEffect(()=>{if(e){const v=parseInt(e,10),R=J.find(S=>S.id===v);R?c(R):n(`/community/chats/${J[0].id}`,{replace:!0})}else c(J[0])},[e,n]);const m=v=>{c(v),n(`/community/chats/${v.id}`)},[u,d]=a.useState(""),[i,p]=a.useState(100),[M,g]=a.useState(null),[C,h]=a.useState(null),[j,N]=a.useState(null),b=a.useRef(null),y=l[s.id]||[],P=a.useCallback(()=>{h(null),N(null),b.current&&(b.current.value="")},[]),T=v=>{const R=v.target.files?.[0];R&&(h(R),R.type.startsWith("image/")?N(URL.createObjectURL(R)):N(null))},A=(v,R,S)=>{const O=typeof v=="number"?v:parseInt(String(v),10);f(G=>({...G,[s.id]:G[s.id].map(x=>x.id===O?{...x,text:R,images:S,edited:!0}:x)}))},_=v=>{const R=typeof v=="number"?v:parseInt(String(v),10);f(S=>({...S,[s.id]:S[s.id].filter(O=>O.id!==R)}))},{user:F}=en(),L=()=>{if(!u.trim()&&!C)return;const R=new Date().toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}),S={id:i,sender:F?.firstName||"You",avatar:F?.imageUrl||"YO",role:"STUDENT",text:u.trim(),images:C&&j?[j]:[],file:C&&!j?C.name:null,time:R,isSent:!0,replyTo:M||void 0};f(O=>({...O,[s.id]:[...O[s.id]||[],S]})),d(""),g(null),P(),p(O=>O+1)},Y=v=>{g({id:v.id,sender:v.sender,text:v.text?.trim()||(v.images?.length?"[Photo]":v.file?`[File: ${v.file}]`:"")})},U=o&&!e,X=!U;return t.jsxs("div",{className:"flex h-screen bg-white",children:[!o||U?t.jsx(hn,{chats:J,selectedChatId:s.id,chatMessages:l,onSelectChat:m}):null,X&&t.jsxs("div",{className:"flex-1 flex flex-col bg-white w-full pb-[80px] sm:pb-0",children:[t.jsx(gn,{selectedChat:s}),t.jsx("div",{className:"flex-1 overflow-y-auto px-4 pt-4",children:y.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg font-medium",children:"No messages yet"}),t.jsx("p",{className:"text-sm",children:"Send a message to start the conversation"})]})}):t.jsx(or,{messages:y,onReply:Y,onEdit:A,onDelete:_})}),t.jsxs("div",{className:"px-4 pt-2 pb-4 bg-white",children:[M&&t.jsx("div",{className:"mb-2",children:t.jsx(rr,{replyingTo:M,onCancel:()=>g(null)})}),t.jsx(sr,{message:u,setMessage:d,onSend:L,fileInputRef:b,onFileSelect:T,selectedFile:C,filePreview:j,onRemoveFile:P})]})]})]})}export{fr as default};
